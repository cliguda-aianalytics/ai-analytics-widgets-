<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A/B Test Widget</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://unpkg.com/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            background: transparent;
            overflow-x: hidden;
        }
        
        /* Custom Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            transition: background 0.3s ease;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* Firefox Scrollbar */
        * {
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Lucide Icons as SVG components
        const AlertTriangle = () => (
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/>
                <line x1="12" y1="9" x2="12" y2="13"/>
                <line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
        );
        
        const TrendingUp = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/>
                <polyline points="16 7 22 7 22 13"/>
            </svg>
        );
        
        const DollarSign = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"/>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
        );
        
        const GitBranch = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="6" y1="3" x2="6" y2="15"/>
                <circle cx="18" cy="6" r="3"/>
                <circle cx="6" cy="18" r="3"/>
                <path d="M18 9a9 9 0 0 1-9 9"/>
            </svg>
        );

        function ABTestWidget() {
            const [animationStep, setAnimationStep] = useState(0);

            useEffect(() => {
                const interval = setInterval(() => {
                    setAnimationStep((prev) => (prev + 1) % 4);
                }, 2000);
                return () => clearInterval(interval);
            }, []);

            const trainMean = 47.82;
            const trainStd = 23.41;
            const testMean = 52.19;
            const testStd = 31.87;

            const samplePrice = 79.99;
            const trainScaled = ((samplePrice - trainMean) / trainStd).toFixed(2);
            const testScaled = ((samplePrice - testMean) / testStd).toFixed(2);

            return (
                <div className="bg-gradient-to-br from-gray-900 to-gray-800" style={{background: 'linear-gradient(to bottom right, #1a202c, #2d3748)'}}>
                    <div className="p-6 text-white max-w-2xl mx-auto">
                        {/* Header */}
                        <div className="flex items-center gap-3 mb-4">
                            <div className="p-2 bg-red-500 bg-opacity-20 rounded-lg">
                                <div className="text-red-400" style={{transform: 'scale(0.8)'}}>
                                    <AlertTriangle />
                                </div>
                            </div>
                            <div>
                                <h2 className="text-xl font-bold">ML-Modell Disaster</h2>
                                <p className="text-gray-400 text-sm">Data Leakage beim Training</p>
                            </div>
                        </div>

                        {/* Scenario */}
                        <div className="bg-gray-800 bg-opacity-50 rounded-lg p-4 mb-4 border border-gray-700">
                            <h3 className="text-base font-semibold mb-2 flex items-center gap-2">
                                <div className="text-blue-400">
                                    <GitBranch />
                                </div>
                                Training Setup
                            </h3>
                            <div className="space-y-2 text-sm">
                                <p>• <span className="text-gray-400">Ziel:</span> ML-Modell für personalisierten Checkout</p>
                                <p>• <span className="text-gray-400">Fehler:</span> StandardScaler separat auf Train & Test angewendet</p>
                                <p>• <span className="text-gray-400">Folge:</span> Überschätzte Performance im Test</p>
                            </div>
                        </div>

                        {/* The Problem */}
                        <div className="grid grid-cols-2 gap-3 mb-4">
                            <div className={`bg-orange-500 bg-opacity-10 rounded-lg p-3 border transition-all duration-500 ${
                                animationStep >= 1 ? 'border-orange-500 shadow-lg' : 'border-orange-500 border-opacity-30'
                            }`} style={{boxShadow: animationStep >= 1 ? '0 10px 15px -3px rgba(251, 146, 60, 0.2)' : 'none'}}>
                                <h4 className="font-semibold text-orange-400 mb-2">Trainings-Daten</h4>
                                <div className="text-sm space-y-1">
                                    <p className="text-gray-300">StandardScaler gefittet:</p>
                                    <p className="font-mono">mean = {trainMean}€</p>
                                    <p className="font-mono">std = {trainStd}€</p>
                                    <div className="mt-2 pt-2 border-t border-orange-500 border-opacity-30">
                                        <p className="text-xs text-gray-400">Beispiel: {samplePrice}€ → {trainScaled}</p>
                                    </div>
                                </div>
                            </div>

                            <div className={`bg-purple-500 bg-opacity-10 rounded-lg p-3 border transition-all duration-500 ${
                                animationStep >= 2 ? 'border-purple-500 shadow-lg' : 'border-purple-500 border-opacity-30'
                            }`} style={{boxShadow: animationStep >= 2 ? '0 10px 15px -3px rgba(139, 92, 246, 0.2)' : 'none'}}>
                                <h4 className="font-semibold text-purple-400 mb-2">Test-Daten</h4>
                                <div className="text-sm space-y-1">
                                    <p className="text-gray-300">StandardScaler neu berechnet:</p>
                                    <p className="font-mono">mean = {testMean}€</p>
                                    <p className="font-mono">std = {testStd}€</p>
                                    <div className="mt-2 pt-2 border-t border-purple-500 border-opacity-30">
                                        <p className="text-xs text-gray-400">Beispiel: {samplePrice}€ → {testScaled}</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* False Results */}
                        <div className={`bg-red-500 bg-opacity-10 rounded-lg p-3 border border-red-500 border-opacity-30 transition-all duration-500 ${
                            animationStep >= 3 ? 'animate-pulse' : ''
                        }`}>
                            <h3 className="text-base font-semibold mb-2 text-red-400 flex items-center gap-2">
                                <TrendingUp />
                                Verfälschte Ergebnisse
                            </h3>
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <p className="text-2xl font-bold text-red-400">+7%</p>
                                    <p className="text-sm text-gray-400">Erwarteter Uplift</p>
                                </div>
                                <div>
                                    <p className="text-2xl font-bold text-green-400">+2%</p>
                                    <p className="text-sm text-gray-400">Tatsächlicher Uplift</p>
                                </div>
                            </div>
                        </div>

                        {/* Consequences */}
                        <div className="mt-4 space-y-2">
                            <h3 className="text-base font-semibold flex items-center gap-2">
                                <div className="text-yellow-400">
                                    <DollarSign />
                                </div>
                                Konsequenzen
                            </h3>
                            <div className="space-y-2 text-sm">
                                <div className="flex items-center gap-3">
                                    <div className="w-2 h-2 bg-red-400 rounded-full animate-pulse" />
                                    <p><span className="text-red-400 font-semibold">2 Monate</span> Entwicklung basierend auf falschen Daten</p>
                                </div>
                                <div className="flex items-center gap-3">
                                    <div className="w-2 h-2 bg-red-400 rounded-full animate-pulse" />
                                    <p><span className="text-red-400 font-semibold">20.000€</span> Entwicklungskosten verschwendet</p>
                                </div>
                                <div className="flex items-center gap-3">
                                    <div className="w-2 h-2 bg-red-400 rounded-full animate-pulse" />
                                    <p><span className="text-red-400 font-semibold">14.000€/Monat</span> erwarteter Uplift bleibt aus</p>
                                </div>
                                <div className="flex items-center gap-3">
                                    <div className="w-2 h-2 bg-red-400 rounded-full animate-pulse" />
                                    <p><span className="text-red-400 font-semibold">Vertrauen</span> in ML-Projekte beschädigt</p>
                                </div>
                            </div>
                        </div>

                        {/* Root Cause */}
                        <div className="mt-4 bg-yellow-500 bg-opacity-10 rounded-lg p-3 border border-yellow-500 border-opacity-30">
                            <p className="text-sm">
                                <span className="font-semibold text-yellow-400">Root Cause:</span> Test-Daten werden separat skaliert statt mit 
                                Trainings-Parametern → Data Leakage beim Model Training!
                            </p>
                        </div>
                    </div>
                </div>
            );
        }

        // Render the component
        ReactDOM.render(<ABTestWidget />, document.getElementById('root'));
    </script>
</body>
</html>